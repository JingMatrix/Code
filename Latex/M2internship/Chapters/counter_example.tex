%! TEX root = ../barycenter.tex

An example of locally compact,
separable and complete but not proper metric space is $\mathbb{R}$ with metric $d(x,y)=\min\{|x-y|,1\}$.
We remark that this example coincides with the restriction of Prokhorov metric, which metricizes weakly convergence of Borel measures on $\mathbb{R}$, to Dirac measures on $\mathbb{R}$.
Discussion for metricized space of measures are available in the next chapter,
now we focus on length space $(E,d)$. Recall that $(E,d)$ is path-connected by assumption.
We prove following proposition for the purpose of constructing counter-examples.

\begin{prop}[Barycenter and midpoint]
	\label{prop:barycenter_midpoint}
	For two points $x,y$ in a length space $(E,d)$, the barycenter of $\mu:=\frac{1}{2}\delta_x + \frac{1}{2}\delta_y$ must be a midpoint between $x$ and $y$. That is to say, a barycenter $z$ satisfies $d(x,z)=d(z,y)=\frac{1}{2}d(x,y)$.
\end{prop}

\begin{proof}
	There are two things to prove.

	If a midpoint $z$ for $x$ and $y$ exits,
	it will attain minimum of following long inequality and thus is a barycenter
	\[
		d(x,y)^2 \leq \left(d(x,z) + d(z,y)\right)^2 \leq 2\left(d(x,z)^2+ d(z,y)^2\right).
	\]

	Now assume the barycenter $z$ of $\mu:=\frac{1}{2}\delta_x + \frac{1}{2} \delta_y$ exists,
	denote $\Gamma$ the set of all rectifiable curves from $x$ to $y$.
	Denote by $L(\gamma)$ the length of rectifiable curve $\gamma$
	and by $\gamma_\frac{1}{2}$ the midpoint of $\gamma$ which exists from the continuity of length
	structure with respect to end points.
	By definition of midpoint $\gamma_{\frac{1}{2}}$ and barycenter $z$,
	$L(\gamma_{[x, \gamma_\frac{1}{2}]}) = L(\gamma_{[\gamma_\frac{1}{2}, y]})$ for $\gamma \in \Gamma$ and
	\[
		d(x,z)^2 + d(z,y)^2 \leq {L(\gamma_{[x, \gamma_\frac{1}{2}]})}^2 + {L(\gamma_{[\gamma_\frac{1}{2}, y]})}^2=\frac{1}{2} {L(\gamma)}^2.
	\]
	Take infimum over all $\gamma$, we have $d(x,z)^2 + d(z,y)^2 \leq \frac{1}{2}d(x,y)^2$.
	This is equivalent to that $z$ is the midpoint of $x$ and $y$.
\end{proof}

\begin{example}[Non-existence of barycenter for length space]
	Locally compact complete length is proper and hence guarantees the existence of barycenter.
	\begin{enumerate}
		\item Locally compact length space is not sufficient for the existence of barycenter.
		      Consider unit disk without origin,
		      from physical intuition and there is no barycenter for uniform measure on it.
		      Or take two center-symmetric points $x = - y$ and measure $\frac{1}{2}\delta_x + \frac{1}{2}\delta_y$ for example.
		\item Complete length space is not sufficient for the existence of barycenter.
		      As we saw in previous proposition, if barycenters always exists then midpoint always exists.
		      However, in a complete length space this is the same as claiming that shortest path always exists,
		      see \cite[Theorem 2.4.16]{burago2001course} for detail.
		      The idea of proof is to firstly construct our shortest path on rational points and then extend it
		      as a well-defined path by completeness and Lipschitz continuous of induced length structure with respect to rational points.
		      We know in addition that there exists complete but not geodesic ``manifold'' in \underline{infinite dimension}.
	\end{enumerate}
\end{example}

A length space is geodesic if shortest path always exists.
It is the same as saying that distance between two points is always realized by the length of some rectifiable curve.

\begin{lem}
	In infinite dimension, there exists a complete but not geodesic Hilbert Riemannian manifold.
\end{lem}

One such example is the infinite dimensional ellipse in Hilbert space $\ell^2$, let $c_n$ be a strictly decreasing sequence with a positive lower bound, define
\[
	E = \left\{ \left( x _ { 1 } , x _ { 2 } , \ldots \right) \in \ell^2 \mid \sum _ { n \in \mathbb { N }^* } \frac { x _ { n } ^ { 2 } } { c _ { n } ^ { 2 } } = 1 \right\}.
\]
We have met the space $E$ in \cref{example:ellipsoid_subspace},
but now we consider smooth structure on it.
Following proof is adapted from \cite[Example 5.1]{grossman1965hilbert}.

\begin{proof}
	Take points $e=(c_1, 0,0,\ldots)$ and $-e=(-c_1, 0,0,\ldots)$,
	we aim to show that $e$ and $-e$ could not be connected by minimizing geodesic.
	We treat $E$ as a smooth sub-manifold of $\ell^2 = \mathbb{R}^\mathbb{N}$.
	Hilbert Riemannian manifold theory is needed to justify the usage of term ``smooth'',
	but we leave out details on it in the proof because of our relatively plain application.

	Define \( T: E \rightarrow E \) by \( T x = y \), where
	\begin{gather*}
		y _ { 1 } = x _ { 1 } , y _ { 2 } = 0 , y _ { i } = \frac{c_i}{c_{i-1}} x_{i-1} \text { for } i \geq 3, \\
		\sum_{n \in \mathbb{N}^*} \frac{y_i^2}{c_i^2} = \frac{x_1^2}{c_1^2} + 0 + \sum_{n \geq 3} \frac{x_{i-1}^2}{c_{i-1}^2}=1.
	\end{gather*}
	We shall show that any smooth curve from \( e\) to \( -e \) is mapped by \( T \)
	to another smooth curve which is strictly shorter than the original one.
	To justify this, recall that on (Hilbert) Riemannian manifold length structure is defined as arc-length integral.
	For a smooth curve $\gamma: [0,1] \rightarrow E$ with arc-length proportional parametrization,
	\[
		L(\gamma) := \int_{0}^{1} \| \gamma^\prime \| \diff \lambda \geq
		\int_{0}^{1} \| T^\prime \cdot \gamma^\prime \| \diff \lambda =: L(T \circ \gamma)
	\]

	Here the tangent map $T^\prime$ is an infinite dimensional matrix with
	diagonal $(1,0,{c_3}/{c_2}, \ldots)$.
	Since $\gamma^\prime$ is continuous,
	we remain to show that at least in an open interval we have strict inequality
	$\| \gamma^\prime \| > \| T^\prime \cdot \gamma^\prime \|$.
	Otherwise, $\gamma^\prime$ has only the first coordinate component on every open interval.
	Integrate $\gamma^\prime$ we should get $\gamma \in \{ e, -e\}$, this is a contradiction.
\end{proof}

To get rid of Hilbert Riemannian manifold theory,
we prove a non-smooth version for this example.
Apparently, $E$ with the metric inherited form $\ell^2$ is not a length space.
To explore more of this example,
we should start to consider induced length metric $\hat{d}$ on $E$ by inherited metric from $\ell^2$.

\begin{lem}
	For $(E, d)$ in \cref{example:ellipsoid_subspace}, where $d$ is the inherited metric from $\ell^2$,
	there is again no shortest path $\gamma$ between two poles $e$ and $-e$
	so that $\hat{d}(e, -e) = L_d (\gamma)$.
\end{lem}

Since we have $ L_d = L_{\hat{d}}$,
this lemma tells that the length space $(E, \hat{d})$ is not geodesic.
In this sense, this lemma is a non-smooth version of the previous one.

\begin{proof}
	We start with a discussion of Lipschitz curves from $[0,1]$ to $(E,d)$ connecting $e$ and $-e$.
	For a Lipschitz curve $\gamma$,
	one can define its derivative $\gamma^\prime: [0,1] \rightarrow \mathbb{R}^\mathbb{N}$ almost everywhere
	and recover classic arc-length integral formula by argument similar to the proof of bounded variation formula
	(\cite[Section 5.3]{Bogachev2007}).
	A rectifiable curve $\gamma$ could take arc-length proportional parametrization on $[0,1]$;
	with this parametrization
	it becomes a Lipschitz curve and $\| \gamma^\prime \|$ is constant almost everywhere.

	Assume now that there exists shortest path between $e$ and $-e$.
	We claim that arc-length variation has the same solution as energy variation
	over Lipschitz curves on $[0,1]$:
	\begin{equation}
		\label{equa:energy_variation_in_E}
		\arg \min_{\gamma} L (\gamma) :=
		\arg \min_{\gamma} \int_{0}^{1} \| \gamma^\prime \| \diff \lambda =
		\arg \min_{\gamma} \int_{0}^{1} \| \gamma^\prime \| ^2 \diff \lambda.
	\end{equation}
	To justify \cref{equa:energy_variation_in_E},
	Cauchy-Schwartz inequality implies that
	solutions to energy variation should have arc-length proportional parametrizations.
	In this case, energy is exactly the square of arc-length so they attain minimum simultaneously.

	We aim to prove that there is no solution to this energy variation problem,
	and thus get a contradiction.
	Pick an integer $n \geq 2$,
	we shall modify $\gamma$ leaving $\gamma_k$ for $ k > n$ unchanged to lower the energy of $\gamma$.
	Define a continuous function
	$ c_{\gamma}(t) := \|(\frac{\gamma_1}{c_1}, \ldots, \frac{\gamma_n}{c_n} )\|$
	and an open subset $A: = c_\gamma^{-1}(0, \infty) \subset [0,1]$.
	Up to choosing a bigger $n$,
	we can assume that $ \gamma_{n-1} \neq 0$ so that $A$ is not empty.
	We modify $\gamma$ only on $A$ to define a curve $\eta$ in $E$,
	\[
		\eta(t) := (0,0,\ldots, c_n c_{\gamma}(t),\gamma_{n+1}(t),\ldots),\quad t \in A.
	\]
	Then on the non-empty open set $A \subset [0,1]$,
	\begin{align*}
		\| \gamma^\prime \|^2 - \| \eta^\prime \|^2 & =
		\|( \gamma_1^\prime,\ldots, \gamma_n^\prime )\|^2- (c_n c_\gamma^\prime)^2                         \\
		                                            & = \|( \gamma_1^\prime,\ldots, \gamma_n^\prime )\|^2-
		((\gamma_1^\prime, \ldots, \gamma_n^\prime) \cdot \frac{1}{c_\gamma}
		(\frac{c_n}{c_1} \frac{\gamma_1}{c_1}, \ldots, \frac{c_n}{c_n} \frac{\gamma_n}{c_n}))^2            \\
		                                            & \geq 0
	\end{align*}
	where we apply Cauchy-Schwartz inequality and the assumption that $c_i$ is strictly decreasing.
	It becomes strict in the set where $\| (\gamma_1^\prime(t), \ldots, \gamma_{n-1}^\prime(t)\| \ne 0$,
	which by our choice of $n$ is not of measure zero.
\end{proof}
